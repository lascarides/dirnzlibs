require 'csv'

outputs = {}

@num = 0

@regions = {
	 "Auckland" => "Auckland",
	 "Manukau" => "Auckland",
	 "Manukau City" => "Auckland",
	 "Orewa" => "Auckland",
	 "Pukekohe" => "Auckland",
	 "Snells Beach" => "Auckland",
	 "Whangaparaoa" => "Auckland",
	 "Waitakere" => "Auckland",
	 "North Shore City" => "Auckland",
	 "Kawerau" => "Bay of Plenty",
	 "Opotiki" => "Bay of Plenty",
	 "Rotorua" => "Bay of Plenty",
	 "Tauranga" => "Bay of Plenty",
	 "Katikati" => "Bay of Plenty",
	 "Te Puke" => "Bay of Plenty",
	 "Whakatane" => "Bay of Plenty",
	 "Amberley" => "Canterbury",
	 "Ashburton" => "Canterbury",
	 "Christchurch" => "Canterbury",
	 "Darfield" => "Canterbury",
	 "Fairlie" => "Canterbury",
	 "Kaikoura" => "Canterbury",
	 "Lincoln" => "Canterbury",
	 "Rangiora" => "Canterbury",
	 "Rolleston" => "Canterbury",
	 "Timaru" => "Canterbury",
	 "Twizel" => "Canterbury",
	 "Waimate" => "Canterbury",
	 "Gisborne" => "Gisborne",
	 "Hastings" => "Hawkes Bay",
	 "Havelock North" => "Hawkes Bay",
	 "Napier" => "Hawkes Bay",
	 "Waipawa" => "Hawkes Bay",
	 "Waipukurau" => "Hawkes Bay",
	 "Wairoa" => "Hawkes Bay",
	 "Dannevirke" => "Manawatu-Whanganui",
	 "Feilding" => "Manawatu-Whanganui",
	 "Levin" => "Manawatu-Whanganui",
	 "Marton" => "Manawatu-Whanganui",
	 "Palmerston North" => "Manawatu-Whanganui",
	 "Taumarunui" => "Manawatu-Whanganui",
	 "Waiouru" => "Manawatu-Whanganui",
	 "Wanganui" => "Manawatu-Whanganui",
	 "Raetihi" => "Manawatu-Whanganui",
	 "Ohakune" => "Manawatu-Whanganui",
	 "Blenheim" => "Marlborough",
	 "Nelson" => "Nelson",
	 "Dargaville" => "Northland",
	 "Kaikohe" => "Northland",
	 "Whangarei" => "Northland",
	 "Hawera" => "Taranaki",
	 "New Plymouth" => "Taranaki",
	 "Stratford" => "Taranaki",
	 "Richmond" => "Tasman",
	 "Motueka" => "Tasman",
	 "Cambridge" => "Waikato",
	 "Hamilton" => "Waikato",
	 "Hamilton East" => "Waikato",
	 "Matamata" => "Waikato",
	 "Ngaruawahia" => "Waikato",
	 "Otorohanga" => "Waikato",
	 "Paeroa" => "Waikato",
	 "Taupo" => "Waikato",
	 "Te Kuiti" => "Waikato",
	 "Thames" => "Waikato",
	 "Tokoroa" => "Waikato",
	 "Te Awamutu" => "Waikato",
	 "Raglan" => "Waikato",
	 "Huntly" => "Waikato",
	 "Turangi" => "Waikato",
	 "Mangakino" => "Waikato",
	 "Morrinsville" => "Waikato",
	 "Te Aroha" => "Waikato",
	 "Carterton" => "Wellington",
	 "Featherston" => "Wellington",
	 "Greytown" => "Wellington",
	 "Hutt City" => "Wellington",
	 "Martinborough" => "Wellington",
	 "Otaki" => "Wellington",
	 "Paraparaumu" => "Wellington",
	 "Porirua" => "Wellington",
	 "Masterton" => "Wellington",
	 "Upper Hutt" => "Wellington",
	 "Lower Hutt" => "Wellington",
	 "Wellington" => "Wellington",
	 "Greymouth" => "West Coast",
	 "Hokitika" => "West Coast",
	 "Westport" => "West Coast",
	 "Alexandra" => "Otago",
	 "Balclutha" => "Otago",
	 "Cromwell" => "Otago",
	 "Dunedin" => "Otago",
	 "Oamaru" => "Otago",
	 "Queenstown" => "Otago",
	 "Arrowtown" => "Otago",
	 "Wanaka" => "Otago",
	 "Gore" => "Southland",
	 "Invercargill" => "Southland",
	 "Winton" => "Southland"
}

@coords = {
	 "IM" => ["-46.4367", "168.3523"],
	 "DTYSL" => ["-46.4224285499056", "168.366814205419"],
	 "ISL" => ["-46.4225", "168.366814205419"],
	 "IPY" => ["-46.4130199140425", "168.355257047743"],
	 "IP" => ["-46.4113132938864", "168.347345389548"],
	 "BALP" => ["-46.2404006966036", "169.740000519874"],
	 "WISP" => ["-46.1428668234257", "168.323791916516"],
	 "GOP" => ["-46.098", "168.9476"],
	 "DSL" => ["-45.877905921362", "170.501495331341"],
	 "DP" => ["-45.8725674928889", "170.503591485306"],
	 "DUL" => ["-45.8705", "170.5109"],
	 "DUHO" => ["-45.8694036495023", "170.518104598163"],
	 "DUM" => ["-45.8680742163283", "170.508678826789"],
	 "DUD" => ["-45.8676294206112", "170.508929657867"],
	 "DTY" => ["-45.8671346648987", "170.519798297042"],
	 "DU" => ["-45.866951027703", "170.511367669943"],
	 "DUS" => ["-45.863420561093", "170.512986344713"],
	 "DKN" => ["-45.8558288231058", "170.525377884434"],
	 "ALP" => ["-45.2561323066784", "169.393194035234"],
	 "OP" => ["-45.0998830837341", "170.969853881071"],
	 "ALPCW" => ["-45.0374", "169.1974"],
	 "QRC" => ["-45.0333258315268", "168.663986966243"],
	 "QP" => ["-45.0286984228859", "168.661700350383"],
	 "QPWKA" => ["-44.6958875234726", "169.135376661972"],
	 "TM" => ["-44.408044091234", "171.256050803383"],
	 "TCY" => ["-44.3993", "171.2445"],
	 "TP" => ["-44.3957170607889", "171.250985612303"],
	 "TWP" => ["-44.2551462309118", "170.096704307614"],
	 "MCKP" => ["-44.1012012869944", "170.827154448139"],
	 "ASP" => ["-43.9031324152587", "171.748102703141"],
	 "LIPL" => ["-43.6412", "172.4715"],
	 "LIU" => ["-43.6422", "172.47"],
	 "LIWO" => ["-43.6422", "172.471"],
	 "CBD" => ["-43.6122737876051", "172.305117156313"],
	 "CM" => ["-43.5349854694427", "172.626176763408"],
	 "CMU" => ["-43.5331989595327", "172.627610425892"],
	 "CPH" => ["-43.5320491078612", "172.631106117517"],
	 "CWA" => ["-43.5319446436319", "172.607663380366"],
	 "CCP" => ["-43.5304904872216", "172.636298930267"],
	 "CP" => ["-43.5298543748666", "172.634385263156"],
	 "CL" => ["-43.5287717870088", "172.633600041725"],
	 "CU" => ["-43.5252401357427", "172.582397762098"],
	 "CUL" => ["-43.5252401357427", "172.582397762098"],
	 "CN" => ["-43.5242994167092", "172.639626161621"],
	 "CMG" => ["-43.5242", "172.5849"],
	 "CUEN" => ["-43.5219646402785", "172.587615271265"],
	 "CESR" => ["-43.5218184556207", "172.587010169466"],
	 "CT" => ["-43.5205545763501", "172.571223575639"],
	 "CUPS" => ["-43.5205052117314", "172.582269394306"],
	 "CPY" => ["-43.5153", "172.6422"],
	 "CCH" => ["-43.5149733050607", "172.622378860714"],
	 "SELP" => ["-43.4888534973088", "172.108845869377"],
	 "CTA" => ["-43.4881", "172.5641"],
	 "RP" => ["-43.304257438536", "172.593512158484"],
	 "AYP" => ["-43.1549883607979", "172.730286031395"],
	 "HKP" => ["-42.7171660232575", "170.961886956484"],
	 "GRSL" => ["-42.4624", "171.1975"],
	 "GRM" => ["-42.4621", "171.1967"],
	 "GRPY" => ["-42.4514353312256", "171.210091518693"],
	 "GRP" => ["-42.4487183723629", "171.209659128812"],
	 "KAIP" => ["-42.4012080494936", "173.681470870452"],
	 "WEP" => ["-41.7517210177245", "171.598147613138"],
	 "BM" => ["-41.5338", "173.956"],
	 "BP" => ["-41.5135681117874", "173.954432779102"],
	 "TASP" => ["-41.3380462274622", "173.183332992925"],
	 "NEMU" => ["-41.3126", "173.2415"],
	 "WM" => ["-41.3108421785785", "174.779658643852"],
	 "WNU" => ["-41.3102", "174.7781"],
	 "WDR" => ["-41.3074085806423", "174.774513520282"],
	 "WPY" => ["-41.3036832979073", "174.774878998305"],
	 "WWA" => ["-41.3020085967608", "174.804572517886"],
	 "WFIB" => ["-41.2983", "174.7811"],
	 "WCN" => ["-41.2979240254435", "174.773971520848"],
	 "WLOT" => ["-41.2968", "174.7818"],
	 "WCC" => ["-41.2956694943385", "174.777684539417"],
	 "WECO" => ["-41.2952306784116", "174.776347146705"],
	 "WYS" => ["-41.2936", "174.7693"],
	 "WCE" => ["-41.278984", "174.787138"],
	 "WJ" => ["-41.27854", "174.775293"],
	 "WHY" => ["-41.2929292075783", "174.779592947492"],
	 "WOCG" => ["-41.292464041836", "174.782900124109"],
	 "WFAM" => ["-41.2921018710021", "174.773050603484"],
	 "WU" => ["-41.2918", "174.7637"],
	 "WUG" => ["-41.2917", "174.7637"],
	 "WER" => ["-41.2912662966113", "174.773505782001"],
	 "WDEV" => ["-41.2912503483568", "174.776896670374"],
	 "WKPM" => ["-41.2908495465292", "174.775429043248"],
	 "WPHS" => ["-41.2907533157478", "174.773480041453"],
	 "WT" => ["-41.2906486492745", "174.745391692991"],
	 "WRG" => ["-41.2903916478742", "174.778270636781"],
	 "WMU" => ["-41.2897958303114", "174.778947144665"],
	 "WBTE" => ["-41.2895310246242", "174.774486025056"],
	 "WPCC" => ["-41.2891938195442", "174.776506900506"],
	 "NEM" => ["-41.2885499961643", "173.278170476201"],
	 "WIZ" => ["-41.2885218284192", "174.7751036651"],
	 "WPW" => ["-41.2886", "174.7751036651"],
	 "WAC" => ["-41.2882798860012", "174.775610602424"],
	 "WPT" => ["-41.2882550371232", "174.778404062095"],
	 "WP" => ["-41.2880706578009", "174.776333349723"],
	 "WHR" => ["-41.2879", "174.7762"],
	 "WDOM" => ["-41.2878", "174.7741"],
	 "WPPTA" => ["-41.2877588172703", "174.775524926114"],
	 "WIHC" => ["-41.2876860623167", "174.775570729372"],
	 "WNUA" => ["-41.28769", "174.775570729372"],
	 "WCO" => ["-41.2899", "174.775"],
	 "WHPT" => ["-41.2870289565257", "174.774370924703"],
	 "WBF" => ["-41.2864416868136", "174.776253643268"],
	 "WBAL" => ["-41.2863075589479", "174.776190328141"],
	 "WEF" => ["-41.2855", "174.7761"],
	 "WB" => ["-41.2847732553921", "174.774047541938"],
	 "WCUL" => ["-41.2849", "174.774047541938"],
	 "WCT" => ["-41.2846587506455", "174.776229494317"],
	 "WPFL" => ["-41.2843433439052", "174.777414999769"],
	 "WBG" => ["-41.2842773344075", "174.776434140016"],
	 "WWAI" => ["-41.2842112366105", "174.774283160868"],
	 "WEX" => ["-41.2837159749199", "174.775451884725"],
	 "WSG" => ["-41.2838", "174.775451884725"],
	 "WDT" => ["-41.2835", "174.7774"],
	 "WQA" => ["-41.2834228648459", "174.774596263402"],
	 "WRWS" => ["-41.2835", "174.774596263402"],
	 "WREO" => ["-41.2834", "174.7771"],
	 "WAL" => ["-41.2832426362077", "174.778125599308"],
	 "WPOR" => ["-41.2831507228169", "174.777072418115"],
	 "WMET" => ["-41.2829732061296", "174.769844075839"],
	 "WFLC" => ["-41.2826703232809", "174.778444478951"],
	 "WRMA" => ["-41.2827", "174.778444478951"],
	 "WIN" => ["-41.2824788572092", "174.778009486555"],
	 "WRU" => ["-41.2819681691164", "174.776073442943"],
	 "WTC" => ["-41.2819131631711", "174.774961580686"],
	 "WLC" => ["-41.281831954207", "174.774971334363"],
	 "WTP" => ["-41.2819", "174.774971334363"],
	 "WAT" => ["-41.2817694616517", "174.777870963718"],
	 "WFS" => ["-41.281651164628", "174.775014226197"],
	 "WTOU" => ["-41.2817", "174.775014226197"],
	 "WMAO" => ["-41.2814114541336", "174.775962932831"],
	 "WSU" => ["-41.2813397970462", "174.77593712404"],
	 "WOM" => ["-41.2812085593418", "174.775097828082"],
	 "WQE" => ["-41.2809447678728", "174.775854849084"],
	 "WD" => ["-41.2809112014571", "174.776868794047"],
	 "WCR" => ["-41.2806483674501", "174.775214081583"],
	 "WLA" => ["-41.2807", "174.775214081583"],
	 "WTPL" => ["-41.2805916284011", "174.780083806157"],
	 "WCOM" => ["-41.2805579725886", "174.775235526835"],
	 "WCOR" => ["-41.2806", "174.775235526835"],
	 "WPEC" => ["-41.2803591770531", "174.775277932443"],
	 "WTEC" => ["-41.2804", "174.775277932443"],
	 "WERO" => ["-41.2801324941483", "174.775964306955"],
	 "WBH" => ["-41.28508", "174.776617"],
	 "WDS" => ["-41.2799270309058", "174.778788369546"],
	 "WOCC" => ["-41.2798646374482", "174.776398844154"],
	 "WAGH" => ["-41.2796997699977", "174.775403451142"],
	 "WCP" => ["-41.2796093750768", "174.775424895847"],
	 "POM" => ["-41.3103", "174.781"],
	 "WINT" => ["-41.2788", "174.775570886458"],
	 "WPCE" => ["-41.2789", "174.775570886458"],
	 "WRB" => ["-41.279", "174.775570886458"],
	 "WRST" => ["-41.2791", "174.775570886458"],
	 "WTR" => ["-41.2791", "174.776"],
	 "WI" => ["-41.2785675601144", "174.774644692792"],
	 "WGA" => ["-41.2784", "174.7766"],
	 "WGAID" => ["-41.2785", "174.7766"],
	 "WPMC" => ["-41.2784", "174.7766"],
	 "WUL" => ["-41.2783623808784", "174.779211785795"],
	 "WCRT" => ["-41.2783", "174.7784"],
	 "WSC" => ["-41.2784", "174.7784"],
	 "WSS" => ["-41.2781", "174.7744"],
	 "WEV" => ["-41.2777749732478", "174.778754201443"],
	 "WL" => ["-41.2777746066275", "174.77877806923"],
	 "WARC" => ["-41.2774698276802", "174.77985627814"],
	 "WCFR" => ["-41.277", "174.779700681788"],
	 "WECD" => ["-41.2771", "174.779700681788"],
	 "WED" => ["-41.277012881091", "174.779700681788"],
	 "WLAC" => ["-41.2770077294392", "174.779449830051"],
	 "WLT" => ["-41.277", "174.779449830051"],
	 "WSE" => ["-41.2771", "174.779449830051"],
	 "WCAL" => ["-41.2769703702864", "174.777777405056"],
	 "WN" => ["-41.2766", "174.7784"],
	 "WTU" => ["-41.2767", "174.7781"],
	 "WNCIC" => ["-41.2765", "174.7783"],
	 "WNRI" => ["-41.2764", "174.7782"],
	 "WAU" => ["-41.276", "174.779914330528"],
	 "WWOM" => ["-41.2761", "174.779914330528"],
	 "NEPY" => ["-41.2758792093088", "173.28966004862"],
	 "WPS" => ["-41.2758", "174.7782"],
	 "WCA" => ["-41.2754654200144", "174.777832345744"],
	 "NESL" => ["-41.2747031413263", "173.280822116565"],
	 "WEDC" => ["-41.2745191422513", "174.77669658095"],
	 "WEC" => ["-41.2732450671622", "174.779312500948"],
	 "WH" => ["-41.273", "174.7777"],
	 "WA" => ["-41.2720934082916", "174.778648728955"],
	 "NECA" => ["-41.2710162539165", "173.293386626899"],
	 "NEP" => ["-41.2707354629478", "173.28310891682"],
	 "LS" => ["-41.2352887238666", "174.917634818111"],
	 "LNU" => ["-41.2328672787427", "174.919723996753"],
	 "PETE" => ["-41.2283371153781", "174.880747856132"],
	 "LM" => ["-41.2249", "174.8884"],
	 "LCAA" => ["-41.2241785425826", "174.864441333753"],
	 "MTP" => ["-41.222750401236", "175.452521285136"],
	 "DTYCW" => ["-45.0454", "169.2087"],
	 "WEDT" => ["-41.2176395959029", "174.931996887329"],
	 "LP" => ["-41.2137", "174.901"],
	 "WPA" => ["-41.2072261053955", "174.907100257221"],
	 "WGE" => ["-41.1957", "174.9326"],
	 "LTOH" => ["-41.2137", "174.901"],
	 "WRES" => ["-41.2829", "174.7767"],
	 "PESR" => ["-41.1476279722173", "174.83973871097"],
	 "POP" => ["-41.132", "174.8399"],
	 "USA" => ["-41.1319359266953", "175.0493970519"],
	 "POCY" => ["-41.1288441965549", "174.840002554012"],
	 "UP" => ["-41.1257550216246", "175.068240808278"],
	 "WPOL" => ["-41.1216989364993", "174.855955000721"],
	 "FP" => ["-41.118778488219", "175.332931163916"],
	 "WBU" => ["-41.1164827030254", "174.951791600023"],
	 "GTP" => ["-41.0763930449081", "175.464879796388"],
	 "CAP" => ["-41.0249378649952", "175.528034075172"],
	 "MP" => ["-40.9488412077775", "175.663180031592"],
	 "MM" => ["-40.9460359861292", "175.673107235617"],
	 "KAP" => ["-40.915486942113", "175.004071320315"],
	 "OTWR" => ["-40.751318644953", "175.135467081642"],
	 "LEP" => ["-40.6233470196191", "175.284187639782"],
	 "PCF" => ["-40.3780004780759", "175.614282547326"],
	 "PDA" => ["-40.3778546073983", "175.606006189189"],
	 "PLE" => ["-40.3778", "175.606006189189"],
	 "PS" => ["-40.3779", "175.606006189189"],
	 "PU" => ["-40.3778", "175.6224"],
	 "PIPC" => ["-40.3750138750781", "175.650747283929"],
	 "PTS" => ["-40.3586609832014", "175.608868349928"],
	 "PP" => ["-40.3560207500141", "175.609673077614"],
	 "PPY" => ["-40.3527", "175.6112"],
	 "PM" => ["-40.337633233371", "175.616308986602"],
	 "PDRC" => ["-40.3307866319989", "175.624567497528"],
	 "PNA" => ["-40.3303", "175.630568271004"],
	 "PSL" => ["-40.3304", "175.630568271004"],
	 "FEP" => ["-40.2246", "175.5654"],
	 "DAP" => ["-40.2092419074941", "176.096701157128"],
	 "MAP" => ["-40.0687255056033", "175.375943471455"],
	 "HAWP" => ["-39.9953043008705", "176.552879155769"],
	 "WAM" => ["-39.9479", "175.0228"],
	 "HAWPW" => ["-39.945089112274", "176.586417658521"],
	 "WAN" => ["-39.931237", "175.056564"],
	 "WACY" => ["-39.9261182855361", "175.045255480251"],
	 "WAP" => ["-39.9034750098847", "175.059312309551"],
	 "HAPHN" => ["-39.6685666305382", "176.881685090105"],
	 "HAAF" => ["-39.6529", "176.8756"],
	 "HAP" => ["-39.6442", "176.8441"],
	 "HAE" => ["-39.6385019271939", "176.845103941236"],
	 "HAPFL" => ["-39.6262430049488", "176.788753230997"],
	 "HAM" => ["-39.6119", "176.7899"],
	 "HWP" => ["-39.5895914038127", "174.284831884639"],
	 "NACY" => ["-39.5445", "176.8432"],
	 "NAP" => ["-39.4923552810368", "176.917510347112"],
	 "NAMU" => ["-39.4887366532159", "176.918666595883"],
	 "HASL" => ["-39.4826801234384", "176.917811332019"],
	 "RUAT" => ["-39.4719", "175.6839"],
	 "RUAM" => ["-39.481", "175.6699"],
	 "TMPRT" => ["-39.4258390494133", "175.275459754665"],
	 "SP" => ["-39.3396394338613", "174.284139404378"],
	 "NPM" => ["-39.0885", "174.054"],
	 "NPOW" => ["-39.0635", "174.0418"],
	 "NPPY" => ["-39.0624986598738", "174.088390795823"],
	 "NPPGB" => ["-39.0584613729083", "174.07024098234"],
	 "NPP" => ["-39.056868060737", "174.073785786931"],
	 "NPTWS" => ["-39.0564672284702", "174.075154335941"],
	 "NPSL" => ["-39.0562", "174.0839"],
	 "NPHM" => ["-39.0370471128009", "174.142441286336"],
	 "WRP" => ["-39.0332493849804", "177.420401847403"],
	 "NPSF" => ["-39.0222080640977", "174.242981105184"],
	 "TMP" => ["-38.8826", "175.2697"],
	 "TPP" => ["-38.6874626643068", "176.068893892313"],
	 "GN" => ["-38.6676", "178.0223"],
	 "GP" => ["-38.6659", "178.0268"],
	 "GCY" => ["-38.6621981798169", "178.023180214155"],
	 "GM" => ["-38.6394051755123", "178.003661437752"],
	 "TPLB" => ["-38.6242670888994", "176.098672675144"],
	 "MGP" => ["-38.3753047287481", "175.765979805666"],
	 "TEKP" => ["-38.3357351516893", "175.167954632441"],
	 "TOCH" => ["-38.2170611576202", "175.872314857395"],
	 "TOP" => ["-38.2151935806439", "175.869541557919"],
	 "OTG" => ["-38.1856459331233", "175.210148786367"],
	 "ROCY" => ["-38.1716177377346", "176.243316095691"],
	 "ROFO" => ["-38.1583", "176.257"],
	 "ROP" => ["-38.1358810302732", "176.252881194158"],
	 "ROM" => ["-38.1344497249672", "176.248100508934"],
	 "ROQM" => ["-38.1329157635438", "176.254719155306"],
	 "KADP" => ["-38.0871648665356", "176.70209800349"],
	 "KATA" => ["-38.0725726747193", "176.718389628809"],
	 "WAIPT" => ["-38.0113263613949", "175.323602977266"],
	 "OPOP" => ["-38.0061917443784", "177.284379383296"],
	 "WKM" => ["-37.9688265789449", "176.978806243443"],
	 "WKW" => ["-37.9584910539123", "176.989846666919"],
	 "WKP" => ["-37.9579", "176.993"],
	 "WKRG" => ["-37.9496453041062", "177.000808361267"],
	 "WAIP" => ["-37.89654", "175.46614"],
	 "WAIPC" => ["-37.89654", "175.46614"],
	 "HTWA" => ["-37.8233509228319", "175.29047264721"],
	 "MPPM" => ["-37.8115617442227", "175.772892212401"],
	 "HM" => ["-37.8043193968736", "175.28099792566"],
	 "WAIKR" => ["-37.7999787032364", "174.868422024418"],
	 "HT" => ["-37.796", "175.3152"],
	 "HU" => ["-37.7881", "175.3188"],
	 "HRG" => ["-37.7922996941291", "175.292986260453"],
	 "HWA" => ["-37.7884", "175.3247"],
	 "HCIR" => ["-37.7875", "175.282310577044"],
	 "HP" => ["-37.7876", "175.282310577044"],
	 "TEPP" => ["-37.7834163095756", "176.325550113932"],
	 "HPY" => ["-37.7829", "175.2726"],
	 "HDAF" => ["-37.78285", "175.351281"],
	 "HWEL" => ["-37.782694219215", "175.278837361103"],
	 "HVLC" => ["-37.7815078885551", "175.315198838098"],
	 "HN" => ["-37.7766", "175.293994865778"],
	 "RUAG" => ["-37.7767", "175.293994865778"],
	 "TUP" => ["-38.988168", "175.806227"],
	 "HPYA" => ["-37.7511", "175.2362"],
	 "TAUY" => ["-37.7365275236959", "176.150209793111"],
	 "TAUM" => ["-37.7079751957279", "176.149462850158"],
	 "TAUT" => ["-37.7047754409894", "176.113539130356"],
	 "TAUP" => ["-37.6832", "176.1696"],
	 "WAIKN" => ["-37.6655911585851", "175.148564321043"],
	 "MPP" => ["-37.6563", "175.530139937359"],
	 "MPPV" => ["-37.6564", "175.530139937359"],
	 "WAIK" => ["-37.5595443659066", "175.158714512247"],
	 "MPPT" => ["-37.5447549524245", "175.712162548782"],
	 "WMTP" => ["-44.7337", "171.0481"],
	 "KTP" => ["-37.3909", "175.835838325621"],
	 "KTPWB" => ["-37.391", "175.835838325621"],
	 "FRAP" => ["-37.2009967384906", "174.905525084604"],
	 "THP" => ["-37.1392305008975", "175.543696532334"],
	 "THEQ" => ["-37.087705858231", "175.30187592452"],
	 "PAPP" => ["-37.0639029226938", "174.941616060615"],
	 "MNGHD" => ["-36.9931224932766", "174.878751890519"],
	 "MNP" => ["-36.9910211200332", "174.876234324723"],
	 "AHE" => ["-36.9893050557616", "174.885232960718"],
	 "MNPY" => ["-36.9622", "174.8691"],
	 "APIE" => ["-36.9579402623137", "174.852901025462"],
	 "AFP" => ["-36.9466", "174.8912"],
	 "OTM" => ["-36.9388", "174.8542"],
	 "ACTS" => ["-36.9384", "174.8508"],
	 "AFPH" => ["-36.9362552530757", "174.879404491491"],
	 "ASG" => ["-36.9290395215743", "174.637330871118"],
	 "AWAT" => ["-36.9212309535645", "174.802943636697"],
	 "AUEN" => ["-36.9199", "174.7732"],
	 "AUAR" => ["-36.9197", "174.7728"],
	 "ABT" => ["-36.9034510912325", "174.808126198999"],
	 "AIA" => ["-36.899362166647", "174.804192675489"],
	 "NSM" => ["-36.895", "174.7752"],
	 "AEE" => ["-36.8929765582071", "174.741758920608"],
	 "AESRA" => ["-36.8919419129154", "174.728301160644"],
	 "AS" => ["-36.8913956714348", "174.724730425499"],
	 "ACA" => ["-36.889439120185", "174.795024866438"],
	 "ALR" => ["-36.8835", "174.8488"],
	 "ACT" => ["-36.88231", "174.71263"],
	 "AT" => ["-36.8820840469149", "174.766818399735"],
	 "AHG" => ["-36.8815101673462", "174.784059643465"],
	 "AWP" => ["-36.8788681277997", "174.632488952472"],
	 "ASJ" => ["-36.8733103763897", "174.837394749095"],
	 "ANAC" => ["-36.8732017165017", "174.781792555095"],
	 "ASL" => ["-36.8723405991744", "174.780457841231"],
	 "APDP" => ["-36.8695567144513", "174.777671492149"],
	 "AKR" => ["-36.8688052404012", "174.7757002882"],
	 "AWM" => ["-36.8675714251264", "174.728824060575"],
	 "ATT" => ["-36.8675280865162", "174.755846006583"],
	 "ABR" => ["-36.8669696686596", "174.774968919898"],
	 "AMHF" => ["-36.8661342096737", "174.757852168553"],
	 "ATON" => ["-36.864938685743", "174.775152391492"],
	 "TAKE" => ["-36.8648883433529", "174.774926755223"],
	 "ACAD" => ["-36.8635558008751", "174.764471954726"],
	 "AWOR" => ["-36.8635426029701", "174.778358310562"],
	 "AFB" => ["-36.8625121338515", "174.780709820886"],
	 "AR" => ["-36.8605", "174.7778"],
	 "AUM" => ["-36.8611437628139", "174.769727127327"],
	 "AMMS" => ["-36.8592810218355", "174.752002476416"],
	 "ABI" => ["-36.8589631680547", "174.635739451718"],
	 "AIST" => ["-36.8582577403406", "174.726796277501"],
	 "ATAY" => ["-36.8579144648093", "174.76223062901"],
	 "ATU" => ["-36.8577", "174.7678"],
	 "AUEL" => ["-36.8560524602692", "174.767477098135"],
	 "ARG" => ["-36.8551790802006", "174.758661616742"],
	 "AGP" => ["-36.8528", "174.8526"],
	 "AART" => ["-36.8515003342328", "174.765869180516"],
	 "APMRL" => ["-36.8514128721736", "174.765160388576"],
	 "APBIS" => ["-36.8514", "174.765160388576"],
	 "AP" => ["-36.8515", "174.765160388576"],
	 "AU" => ["-36.8512", "174.7693"],
	 "ASB" => ["-36.8501085200828", "174.762816810581"],
	 "APFL" => ["-36.8494", "174.7649"],
	 "AL" => ["-36.8490004304818", "174.773162336668"],
	 "ANEW" => ["-36.8488865731659", "174.77078186551"],
	 "APU" => ["-36.8484", "174.7349"],
	 "AWC" => ["-36.8481", "174.7674"],
	 "AUL" => ["-36.848", "174.7722"],
	 "ATV" => ["-36.8478719029289", "174.76125704273"],
	 "AAF" => ["-36.8475656517945", "174.748599144529"],
	 "AWWC" => ["-36.8474", "174.7462"],
	 "AIS" => ["-36.847", "174.7654"],
	 "ABG" => ["-36.8469", "174.768276191094"],
	 "ARU" => ["-36.847", "174.768276191094"],
	 "AEY" => ["-36.8469", "174.76811856251"],
	 "AHH" => ["-36.847", "174.76811856251"],
	 "ARWS" => ["-36.8465", "174.7656"],
	 "ABNZ" => ["-36.8466", "174.7656"],
	 "ABP" => ["-36.8459947744918", "174.75646554981"],
	 "ABOS" => ["-36.8456", "174.7644"],
	 "AKPM" => ["-36.8451", "174.75745198745"],
	 "AYS" => ["-36.8452", "174.75745198745"],
	 "AHUR" => ["-36.8447", "174.7666"],
	 "AMAR" => ["-36.8429", "174.7664"],
	 "ABF" => ["-36.8426", "174.764442151032"],
	 "APRI" => ["-36.8427", "174.764442151032"],
	 "AEM" => ["-36.8318241138532", "174.745027917954"],
	 "NSPDV" => ["-36.8288139085846", "174.797883383932"],
	 "NSPNC" => ["-36.8012900954557", "174.747104059669"],
	 "NSPBK" => ["-36.7956770347978", "174.729244073469"],
	 "NSP" => ["-36.7892", "174.772595354546"],
	 "NSPTK" => ["-36.7893", "174.772595354546"],
	 "NSPGF" => ["-36.7811677260291", "174.7230096148"],
	 "AMCE" => ["-36.7585867041113", "174.595603483013"],
	 "ABAL" => ["-36.7574523543515", "174.589528609088"],
	 "TAKA" => ["-36.7432286290134", "174.736006477822"],
	 "NSPAL" => ["-36.7251953238818", "174.694440134369"],
	 "NSPEC" => ["-36.7144207775983", "174.747183618751"],
	 "RODP" => ["-36.5867143911627", "174.694251980526"],
	 "DARK" => ["-35.9354587507966", "173.862091734364"],
	 "WHCY" => ["-35.7396375638995", "174.305992592236"],
	 "WHM" => ["-35.7359431049336", "174.299620000262"],
	 "WHCL" => ["-35.7233", "174.3165"],
	 "WHP" => ["-35.7234", "174.3165"],
	 "WHNL" => ["-35.7086296037598", "174.320895886864"],
	 "FNP" => ["-35.2294031277805", "173.951405849861"],
	 "SUU" => ["-18.123665", "178.459511"],
	 "NUSL" => ["-13.840913", "-171.748238"],
	 "TMPOK" => ["-39.4173", "175.4008"],
}


CSV.foreach('directory.csv', :headers => true) do |row|

	@row = row
	multiple_interloans = false

	# Fix shortened postcode
	['Street Post Code', 'Postal Post Code'].each do |code_label|
		if @row[code_label].to_s.length == 3
			@row[code_label] = "0#{@row[code_label]}"
		end
	end

	if outputs[@row['Symbol']].nil?
		outputs[@row['Symbol']] = @row
	else
		@row.each do |k,v|
			if outputs[@row['Symbol']][k].to_s.strip != @row[k].to_s.strip 

				interloan_fields = [
					'Interloan Librarian',
					'Interloan Librarian Title',
					'Email interloan',
					'Phone interloan',
					'Fax interloan'
				]

				# Records with multiple interloan librarians
				# FIXME: Hardcoded. Can we figure out an algorithm here?
				multiple_interloans = ['APMRL', 'KTP', 'OTM', 'WIN']

				if outputs[@row['Symbol']][k].to_s.strip != '' and @row[k].to_s.strip != ''
					if interloan_fields.include? k and multiple_interloans.include? @row['Symbol']
						# Does this record have more than one interloan librarian?
						# If so, use the Alt fields
						outputs[@row['Symbol']]['Alt ' + k] = v
					else 
						# Is this just two different values for one field? 
						# If so, use the latest one.
						outputs[@row['Symbol']][k] = v
					end
				else
					# Is this one value filled in and one blank?
					# If so, use the filled in one.
					outputs[@row['Symbol']][k] = outputs[@row['Symbol']][k].to_s.strip + v.to_s.strip
				end
			end
		end
	end

	# Concat addresses
	row['Street Address'] = [
		row['Street Address 1'], 
		row['Street Address 2'],
		row['Street Address 3'],
		row['Street Address 4'],
		row['Street City'], 
		row['Street Post Code'],
		row['Street State']
	].compact.join(', ') 

	row['Postal Address'] = [
		row['Postal Address 1'], 
		row['Postal Address 2'],
		row['Postal Address 3'],
		row['Postal Address 4'],
		row['Postal City'], 
		row['Postal Post Code'],
		row['Postal State']
	].compact.join(', ') 

	# Add city, state, region, lat, long
	row['City'] = row['Street City'].to_s.strip
	row['City'].gsub!(/\d/, '')
	row['City'].gsub!("rHutt", 'r Hutt')
	row['City'].gsub!("New Zealand", 'Wellington')
	row['City'].strip!
	row['Region'] = @regions[row['City']]
	unless @coords[row['Symbol']].nil?
		row['Latitude'] = @coords[row['Symbol']][0]
		row['Longitude'] = @coords[row['Symbol']][1]
	end

	# Both status fields are the same.
	row['NZ Int scheme member'] = row['Status in NZ IL Scheme']

end

cols = "Name,Library Type,Account Type,Account Status,Maori Name,Symbol,Street Address,Postal Address,Web Address,Main phone,Main Fax,Email,Notes,Alternative Names,NZ Int scheme member,Special Memberships,Manager,Library Manager Title,Manager email,Library Manager Fax,Library Manager Phone,Interloan Librarian,Interloan Librarian Title,Email interloan,Phone interloan,Fax interloan,Alt Interloan Librarian,Alt Interloan Librarian Title,Alt Email interloan,Alt Phone interloan,Alt Fax interloan,Reciprocal Arrangements,Te Puna int member,Status in NZ IL Scheme,Library Status,IBS member,Std Loan standard charge,Std Loan International Charge,Std Copy Standard Charge,Std Copy International Charge,Std Notes,International Notes,Urgent loan Standard Charge,Urgent Loan International Charge,Urgent Copy Standard Charge,Urgent Copy International Charge,City,Region,Latitude,Longitude"

puts cols

cols = cols.split(',')

outputs.each do |sym, row|
	cols.each do |col|
		print '"' + row[col].to_s.gsub('"', '""').strip + '",'
	end
	puts
end